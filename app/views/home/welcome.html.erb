
<h4>最新熱門列表</h4>
<div id="glider-container-trending" slide-amount='0'>
  <div id="glider-pan-left"><span class="glyphicon glyphicon-chevron-left"></span></div>
  <div id="mix-window-wrapper">
    <% @trending_mixes.each do |mix| %>
      <%= render 'mixes/mix', mix: mix %>
    <% end %>
  </div>
  <div id="glider-pan-right"><span class="glyphicon glyphicon-chevron-right"></span></div>
</div>
<div class="clear-both">

<% if user_logged_in? %>
  <h4>喜愛列表</h4>
  <div id="glider-container-favor" slide-amount='0'>
    <div id="glider-pan-left"><span class="glyphicon glyphicon-chevron-left"></span></div>
    <div id="mix-window-wrapper">
      <% @favorite_ary.each do |mix| %>
        <%= render 'mixes/mix', mix: mix %>
      <% end %>
    </div>
    <div id="glider-pan-right"><span class="glyphicon glyphicon-chevron-right"></span></div>
  </div>
<% end %>
<h4>熱門標籤</h4>
<hr>
<%= render 'shared/hot_tags' %>

<script type="text/javascript">
  // Ajax double request bug fix
  //$('body').off('ajax:beforeSend');
  //$("body").on('ajax:beforeSend', function (status, xhr, settings) {
  //  xhr.abort();
  //});

  // Glider left and right function start ------>
  function init_glider_for (glide_container) {
    //var glide_container = $("#glider-container-trending");
    var pan_left = glide_container.find("#glider-pan-left");
    var pan_right = glide_container.find("#glider-pan-right");
    var mix_window_wrapper = glide_container.find("#mix-window-wrapper");
    pan_right.off('click');
    pan_right.on('click', function() {
      var slide_amount = glide_container.attr('slide-amount');
      var slide_amount_int = parseInt(slide_amount);
      if (slide_amount_int <= -1110) return;
      var slide_to = slide_amount_int - 555;
      //console.log("Current slide amount: " + slide_amount);
      mix_window_wrapper.animate({left: slide_to.toString()+'px'}, 300, 'swing');
      glide_container.attr('slide-amount', slide_to.toString());
    });
    pan_left.off('click');
    pan_left.on('click', function() {
      var slide_amount = glide_container.attr('slide-amount');
      var slide_amount_int = parseInt(slide_amount);
      if (slide_amount_int >= 0) { return; }
      var slide_to = slide_amount_int + 555;
      console.log("Current slide amount: " + slide_amount);
      mix_window_wrapper.animate({left: slide_to.toString()+'px'}, 300, 'swing');
      glide_container.attr('slide-amount', slide_to.toString());
    });
  }
  init_glider_for($("#glider-container-trending"));
  init_glider_for($("#glider-container-favor"));
  // Glider left and right function end <------
</script>
